<script type="text/javascript" >

	function element_is_in_tags(el, tags) {

		for (var id in tags) {

			if(!el.classList.contains("editions-box-hideable-" + tags[id])){
				return false;
			}

		}
		return true;
	}

	function show_only_editions_with_tags(tags) {

		var els = document.getElementsByClassName('editions-box-hideable');

		[].forEach.call(els, function (el)
		{
			if (tags.length == 0) {
				el.style.display = "none";
			}
			else {

				if(element_is_in_tags(el, tags)) {
					el.style.display = "inline-block";
				}
				else {
					el.style.display = "none";
				}
			}
		});
	}
	function update_editions_tags(id) {
		var tag_filter = [];
		tag_filter.push( id );
		show_only_editions_with_tags(tag_filter)
	}
</script>

<aside id="downloads" style="transition: height .5s;">
    <div class="text-center">
        <div class="call-to-action">
				<div class="btn-group" role="group" aria-label="Basic example">
            {{ range .Params.filters }}				
						<button type="button" class="btn btn-sm" id="show-editions-{{ .id }}" onclick="update_editions_tags('{{ .id }}');" {{ .default }}>{{ .description }}</button>
            {{ end }}
            </div>
            <div class="container-fluid" style="min-height: 503px;">
                <div class="editions-grid fluid-row align-items-center no-gutters">
                <!--
                NOTE: The range and end operations are supposed to be in line with the boxes!!!
                Read more about crazy HTML magic here: http://stackoverflow.com/questions/19038799/why-is-there-an-unexplainable-gap-between-these-inline-block-div-elements
                -->
                {{ range .Site.Pages }}{{ if eq .Type "download-edition" }}<div class="editions-box-hideable {{ range .Params.tags}}editions-box-hideable-{{ . }} {{ end }} col-lg-4 col-sm-6">
                <a href="{{ .Permalink }}" class="editions-box editions-link" >
                <img src="/img/editions/{{ .Params.thumbnail }}" class="img-responsive" alt="">
                <div class="editions-box-caption-extended">
                    <div class="editions-box-caption-extended-content">
                        <div class="targetgroup">
                            {{ .Params.targetgroup }}
                        </div>
                    </div>
                </div>
                <div class="editions-box-caption-small">
                    <div class="editions-box-caption-small-content">
                        <div class="name">
                            {{ .Params.name }}
                        </div>
                    </div>
                </div>
                <div class="editions-box-caption-extended-subtitle">
                    <div class="editions-box-caption-extended-subtitle-content">
                        <div class="action">
                            {{ .Params.name }}
                        </div>
                    </div>
                </div>
                </a>
            </div>{{ end }}{{ end }}
		</div>
		<div class="content col-md-8 ml-auto mr-auto text-left">
				<p>{{ .Content | markdownify }}</p>
		</div>		
    </div>
</section>

</aside>

<script type="text/javascript">
	update_editions_tags();
</script>
